<!doctype html>
<meta charset="utf-8">
<button id="btn">POSTテスト（保存）</button>
<pre id="out"></pre>
<script>
const API_URL = "https://script.google.com/macros/s/AKfycbxVT20cF2cEQwbXWEn4_MlvKBDAq9YTW6mcewmPz8imWyrR39MnuqdPxQ9ZXO9Q91JG/exec";
const API_TOKEN = "kids-2026-0130-asahi-0620";

document.getElementById("btn").onclick = async () => {
  const payload = {
    token: API_TOKEN,
    mode: "save",
    key: "allowance_book_v1",
    data: [{ id: "test", date: "2026-01-30", type: "in", desc: "POSTテスト", amount: 123 }]
  };

  try{
    const res = await fetch(API_URL, {
      method: "POST",
      headers: { "Content-Type": "text/plain;charset=utf-8" },
      body: JSON.stringify(payload)
    });
    const txt = await res.text();
    document.getElementById("out").textContent =
      "HTTP " + res.status + "\n\n" + txt;
  }catch(e){
    document.getElementById("out").textContent =
      "FETCH失敗: " + (e?.message || e);
  }
};
</script>
